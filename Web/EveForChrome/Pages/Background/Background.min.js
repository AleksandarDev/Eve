var RunAt=function(){function n(){}return n.Start="document_start",n.End="document_end",n.Idle="document_idle",n}(),Background=function(){function n(){this.webSocketPort="41258",this.webSocketHost="ws://localhost",this.InitializeWebSockets()}return n.prototype.InitializeWebSockets=function(){this.webSocketHost+=":"+this.webSocketPort,this.webSocket=new WebSocket(this.webSocketHost),this.webSocket.onmessage=this.WebSocketOnMessage.bind(this),this.webSocket.onopen=this.WebSocketOnOpen.bind(this),this.webSocket.onclose=this.WebSocketOnClose.bind(this),this.webSocket.onerror=this.WebSocketOnError.bind(this)},n.prototype.WebSocketOnMessage=function(n){var t=this;try{console.log("Got message: "),console.log(n),chrome.tabs.query({},function(i){for(var r=0;r<i.length;r++)t.ExecuteScript(i[r].id,n.data)})}catch(i){console.warn(i)}},n.prototype.WebSocketOnOpen=function(){console.log("Socket opened to ["+this.webSocketHost+"]")},n.prototype.WebSocketOnClose=function(){console.log("Socket closed!")},n.prototype.WebSocketOnError=function(){console.error(event)},n.prototype.ExecuteScript=function(n,t,i,r){typeof i=="undefined"&&(i=!1),typeof r=="undefined"&&(r=RunAt.End),chrome.tabs.executeScript(n,{code:"var scriptToInject = document.createElement('script'); scriptToInject.type = 'text/javascript'; scriptToInject.innerHTML = '"+t+"'; document.getElementsByTagName('head')[0].appendChild(scriptToInject);",allFrames:i,runAt:"document_end"},this.ScriptExecutionCallback)},n.prototype.ScriptExecutionCallback=function(n){console.log("Script executed!"),n!==undefined&&(console.log("Script results: "),console.log(n))},n}(),background=new Background